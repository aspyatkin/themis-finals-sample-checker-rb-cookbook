(0...<%= @processes %>).to_a.each do |num|
  God.watch do |w|
    w.group = '<%= @service_alias %>'
    w.name = "<%= @service_alias %>-#{num}"
    w.dir = '<%= @basedir %>'
    w.uid = '<%= @user %>'
    w.gid = '<%= @group %>'
    w.log = "<%= @basedir %>/logs/checker-#{num}.log"
    w.start = 'bundle exec ruby checker.rb'
    w.env = {
      'BEANSTALKD_URI' => '<%= @beanstalkd_uri %>',
      'LOG_LEVEL' => '<%= @log_level %>',
      'STDOUT_SYNC' => '<%= @stdout_sync %>',
      'TUBE_LISTEN' => '<%= @beanstalkd_tube_namespace %>.service.<%= @service_alias %>.listen',
      'TUBE_REPORT' => '<%= @beanstalkd_tube_namespace %>.service.<%= @service_alias %>.report'
    }
    w.stop_signal = 'INT'
    w.keepalive
  end
end
